# Shell-скрипты для демонстрации этапов

Набор shell-скриптов для последовательной демонстрации всех этапов разработки проекта.

## Доступные скрипты

### Отдельные этапы

- `run_stage1.sh` - Этап 1: Минимальный прототип с конфигурацией
- `run_stage2.sh` - Этап 2: Сбор данных о зависимостях
- `run_stage3.sh` - Этап 3: Построение графа зависимостей
- `run_stage4.sh` - Этап 4: Обратные зависимости
- `run_stage5.sh` - Этап 5: Визуализация графа

### Полная демонстрация

- `run_all_stages.sh` - Запуск всех этапов последовательно

## Использование

### Linux / macOS / WSL

```bash
# Сделать скрипты исполняемыми
chmod +x run_stage*.sh run_all_stages.sh

# Запуск отдельного этапа
./run_stage1.sh

# Запуск всех этапов
./run_all_stages.sh
```

### Git Bash (Windows)

```bash
# Скрипты можно запускать напрямую
bash run_stage1.sh

# Или сделать исполняемыми
chmod +x run_stage1.sh
./run_stage1.sh
```

### Альтернативный запуск

```bash
# Через zsh
zsh run_stage1.sh

# Через bash
bash run_stage1.sh

# Через sh
sh run_stage1.sh
```

## Описание этапов

### Этап 1: Минимальный прототип
- Демонстрация парсинга аргументов
- Валидация параметров
- Обработка ошибок
- Вывод конфигурации

**Тесты:**
- ✅ Корректные параметры
- ✅ Тестовый режим с фильтром
- ✅ Обработка ошибок (отрицательная глубина)
- ✅ Обработка ошибок (неверное расширение)
- ✅ Справка

### Этап 2: Сбор данных
- Загрузка APKINDEX из репозитория
- Парсинг формата Alpine Linux
- Получение прямых зависимостей

**Тесты:**
- ✅ busybox (минимальные зависимости)
- ✅ alpine-base (множество зависимостей)
- ✅ musl (без зависимостей)
- ✅ Тестовый репозиторий

### Этап 3: Построение графа
- DFS без рекурсии
- Транзитивные зависимости
- Обработка циклов
- Фильтрация и ограничение глубины

**Тесты:**
- ✅ Простой граф (пакет A)
- ✅ Циклические зависимости (пакет L)
- ✅ Фильтрация (пакет W, исключить Y)
- ✅ Ограничение глубины (пакет P, depth=1)
- ✅ Сложный цикл (пакет W)

### Этап 4: Обратные зависимости
- Поиск пакетов, зависящих от данного
- Учет транзитивности

**Тесты:**
- ✅ Базовая зависимость (пакет G)
- ✅ Популярная зависимость (пакет I)
- ✅ Пакет в цикле (пакет A)
- ✅ С фильтрацией (пакет Z)
- ✅ Без обратных зависимостей (пакет P)

### Этап 5: Визуализация
- Генерация Mermaid кода
- Экспорт в SVG
- Демонстрация на трех пакетах

**Примеры:**
- ✅ Простой граф (пакет A, 9 узлов)
- ✅ С циклами (пакет L, 13 узлов)
- ✅ Линейная цепь (пакет P, 7 узлов)

## Требования

- **Python 3.7+**
- **Bash/Zsh/Sh** - любой POSIX-совместимый shell
- **Git** (опционально, для run_all_stages.sh)
- **Интернет** (для этапа 2 при работе с реальными репозиториями)

## Примечания

### Время выполнения

- **Этап 1**: ~1-2 секунды (локально)
- **Этап 2**: ~5-10 секунд (загрузка APKINDEX при первом запуске)
- **Этап 3**: ~1-2 секунды (тестовый репозиторий)
- **Этап 4**: ~1-2 секунды (тестовый репозиторий)
- **Этап 5**: ~1-2 секунды (тестовый репозиторий)

**Общее время**: ~10-20 секунд

### Генерация SVG

Скрипты создают SVG файлы с предварительным просмотром. Для полноценной визуализации:

1. **Установите Mermaid CLI:**
   ```bash
   npm install -g @mermaid-js/mermaid-cli
   ```

2. **Или используйте онлайн:**
   - Откройте https://mermaid.live
   - Вставьте содержимое .mmd файла

### Очистка

```bash
# Удалить сгенерированные файлы
rm -f *.svg *.mmd

# Удалить только тестовые файлы
rm -f test*.svg graph_*.svg graph_*.mmd
```

## Структура проекта

```
config-valia/
├── dependency_visualizer.py    # Основной файл
├── test_repo.txt              # Тестовый репозиторий
├── run_stage1.sh              # Этап 1
├── run_stage2.sh              # Этап 2
├── run_stage3.sh              # Этап 3
├── run_stage4.sh              # Этап 4
├── run_stage5.sh              # Этап 5
├── run_all_stages.sh          # Все этапы
├── SCRIPTS_README.md          # Эта документация
└── README.md                  # Основная документация
```

## Решение проблем

### Проблема: Permission denied

```bash
chmod +x run_stage*.sh run_all_stages.sh
```

### Проблема: python3 not found

```bash
# Проверьте установку Python
python3 --version

# Или используйте python вместо python3
# Отредактируйте скрипты: заменить python3 на python
```

### Проблема: Скрипт не запускается в Windows

Используйте Git Bash или WSL:
```bash
# Git Bash
bash run_stage1.sh

# WSL
wsl bash run_stage1.sh
```

## Дополнительная информация

- **README.md** - Основная документация проекта
- **VISUALIZATION_EXAMPLES.md** - Примеры визуализации и сравнение
- **SUMMARY.md** - Полный итоговый отчет

## Лицензия

MIT License
